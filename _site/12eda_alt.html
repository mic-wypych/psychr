<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>r_website - Explporatory Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">r_website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-basics" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Basics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-basics">    
        <li>
    <a class="dropdown-item" href="./01r_intro.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02basic_data.html">
 <span class="dropdown-text">Basic objects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03data_types.html">
 <span class="dropdown-text">Data types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04loops_conditionals.html">
 <span class="dropdown-text">Loops and conditionals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05functions.html">
 <span class="dropdown-text">Functions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-working-with-data" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Working with data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-working-with-data">    
        <li>
    <a class="dropdown-item" href="./06loading_data.html">
 <span class="dropdown-text">Loading data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./07data_wrangling.html">
 <span class="dropdown-text">Data wrangling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./08join_restructure.html">
 <span class="dropdown-text">Joining and restructuring data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./09data_viz_1.html">
 <span class="dropdown-text">Vizualization vol 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./10data_viz_2.html">
 <span class="dropdown-text">Vizualization vol 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analyzing-data" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analyzing data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analyzing-data">    
        <li>
    <a class="dropdown-item" href="./12eda.html">
 <span class="dropdown-text">Exploratory analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./16regression.html">
 <span class="dropdown-text">Simple regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./18statistical_control.html">
 <span class="dropdown-text">Statistical control</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-basic-information-about-the-dataset" id="toc-getting-basic-information-about-the-dataset" class="nav-link active" data-scroll-target="#getting-basic-information-about-the-dataset">Getting basic information about the dataset</a></li>
  <li><a href="#exploring-via-plots" id="toc-exploring-via-plots" class="nav-link" data-scroll-target="#exploring-via-plots">Exploring via plots</a>
  <ul class="collapse">
  <li><a href="#a-cautionary-tale-the-boring-way" id="toc-a-cautionary-tale-the-boring-way" class="nav-link" data-scroll-target="#a-cautionary-tale-the-boring-way">A cautionary tale the boring way</a></li>
  <li><a href="#a-cautionary-tale-the-fun-way" id="toc-a-cautionary-tale-the-fun-way" class="nav-link" data-scroll-target="#a-cautionary-tale-the-fun-way">A cautionary tale the fun way</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Explporatory Data Analysis</h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p>Usually once you get the data for your analysis the first thing you want to do is get to know it and briefly browse through it to know e.g.&nbsp;what variables are in the dataset, how many observations you have etc. You might feel the urge to jump right into answering your key research questions. After all, usually data collection is a laborious and tiring process and you are so curious to check what the results are! But it’s best to set aside the main analyses for a moment and first take a closer look at the data. Why? It is a necessary steps because there is a near-infinite number of things that can go wrong when preparing the data from errors in how data was coded to errors in preprocessing or loading the files. Lots of things can also happen that can make analysis or drawing conclusions difficult. These can range from issues with your measures (e.g.&nbsp;reliability) through unexpected behaviour of participants during the study (e.g.&nbsp;non-compliance, reactance, purposufely giving ridiculous answers) all the way to errors in the data (e.g.&nbsp;items not recoded or errors in coding, values out of range etc.). Generally exploring the data is not so much about writing/using proper functions but about thinking what could possibly be off with the data to prepare yourself before further analyses.</p>
<p>How to best get to know a new dataset? You can work with datasets from various sources. If it’s your study that you’re analyzing, then you probably know everything about the variables that should be in it, how many particiapnts took part in the study, how variables are coded etc. However, you might also be working with datasets provided by other people (e.g.&nbsp;by a colleague who ran the study, by a company, or you got the data from an open repository). In these situation it is crucial that you can get to know your data. Many of such datasets will have a codebook available which should describe it in detail. Unfortunately that is not always the case (codebook is like documentation - super important but nobody wants to do it). If a codebook is available, read it (this still does not allow you to skip checking for potential errors/problems with the data). If you don’t have a codebook you need to check everything yourself. Fortunately there is a lot of functions in R that make it a lot easier.</p>
<p>Lets starts with just general first look at the data. We might want to see how many observations we have, how many columns there are, and the names and types of columns. <code>dplyr</code> has a very nice function for it called <code>glimpse()</code>. It’s more concise than <code>str()</code> but gives you more information than e.g.&nbsp;<code>head()</code>. We will work with a dataset on bike sharing. The dataset is powered by TfL Open Data. and contains OS data © Crown copyright and database rights 2016’ and Geomni UK Map data © and database rights [2019]. You can find the link to the data as well as codebook for variables <a href="https://www.kaggle.com/datasets/hmavrodiev/london-bike-sharing-dataset">here</a>. Lets load our dataset and have a firsty look at it!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>bikes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/london_merged.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bikes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 17,414
Columns: 10
$ timestamp    &lt;dttm&gt; 2015-01-04 00:00:00, 2015-01-04 01:00:00, 2015-01-04 02:…
$ cnt          &lt;dbl&gt; 182, 138, 134, 72, 47, 46, 51, 75, 131, 301, 528, 727, 86…
$ t1           &lt;dbl&gt; 3.0, 3.0, 2.5, 2.0, 2.0, 2.0, 1.0, 1.0, 1.5, 2.0, 3.0, 2.…
$ t2           &lt;dbl&gt; 2.0, 2.5, 2.5, 2.0, 0.0, 2.0, -1.0, -1.0, -1.0, -0.5, -0.…
$ hum          &lt;dbl&gt; 93.0, 93.0, 96.5, 100.0, 93.0, 93.0, 100.0, 100.0, 96.5, …
$ wind_speed   &lt;dbl&gt; 6.0, 5.0, 0.0, 0.0, 6.5, 4.0, 7.0, 7.0, 8.0, 9.0, 12.0, 1…
$ weather_code &lt;dbl&gt; 3, 1, 1, 1, 1, 1, 4, 4, 4, 3, 3, 3, 4, 3, 3, 3, 3, 3, 3, …
$ is_holiday   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ is_weekend   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ season       &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, …</code></pre>
</div>
</div>
<section id="getting-basic-information-about-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="getting-basic-information-about-the-dataset">Getting basic information about the dataset</h2>
<p>Before we do any analysis there are a few things to clean. Firstly some variables are factors according to the codebook but are coded as numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="ot">&lt;-</span> bikes <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"weather_code"</span>, <span class="st">"is_holiday"</span>, <span class="st">"is_weekend"</span>, <span class="st">"season"</span>), as.factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are also a few variables that are coded with numbers but have corresponding values: <code>weather_code</code> and <code>season</code>. Recoding them will make it easier to work with them (we will use slightly abbreviated names for <code>weather_code</code> to keep them more readable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="ot">&lt;-</span> bikes <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">recode</span>(season, <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"spring"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"summer"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"fall"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"winter"</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">weather_code =</span> <span class="fu">recode</span>(weather_code, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"clear"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"scattered clouds"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Broken clouds"</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Cloudy "</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"7"</span> <span class="ot">=</span> <span class="st">"Rain"</span>, <span class="st">"10"</span> <span class="ot">=</span> <span class="st">"rain with thunderstorm"</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"26"</span> <span class="ot">=</span> <span class="st">"snowfall"</span>, <span class="st">"94"</span> <span class="ot">=</span> <span class="st">"Freezing Fog"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is a number of things we might want to look at to get to know the data better. Lets start with the numeric columns. A good point to start is to look at some summary statistics like means, standard deviations, minimum and maximum values (we’ll use <code>knitr::kable()</code> just to make the table look nicer in the output).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sd =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> T),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">min =</span> <span class="fu">min</span>(value, <span class="at">na.rm =</span> T), </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">max =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of bare predicate functions was deprecated in tidyselect 1.1.0.
ℹ Please use wrap predicates in `where()` instead.
  # Was:
  data %&gt;% select(is.numeric)

  # Now:
  data %&gt;% select(where(is.numeric))</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cnt</td>
<td style="text-align: right;">1143.10164</td>
<td style="text-align: right;">1085.108068</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">7860.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">hum</td>
<td style="text-align: right;">72.32495</td>
<td style="text-align: right;">14.313186</td>
<td style="text-align: right;">20.5</td>
<td style="text-align: right;">100.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t1</td>
<td style="text-align: right;">12.46809</td>
<td style="text-align: right;">5.571818</td>
<td style="text-align: right;">-1.5</td>
<td style="text-align: right;">34.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">t2</td>
<td style="text-align: right;">11.52084</td>
<td style="text-align: right;">6.615145</td>
<td style="text-align: right;">-6.0</td>
<td style="text-align: right;">34.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_speed</td>
<td style="text-align: right;">15.91306</td>
<td style="text-align: right;">7.894570</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">56.5</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can also look at other variables that aren’t numeric - lets look at the <code>weather_code</code> variable as an example. Lets see which countries are available and for which countries we have the most reviews. We can do it by combining <code>count()</code> with <code>arrange()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(weather_code) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  weather_code                 n
  &lt;fct&gt;                    &lt;int&gt;
1 "clear"                   6150
2 "scattered clouds"        4034
3 "Broken clouds"           3551
4 "Rain"                    2141
5 "Cloudy "                 1464
6 "snowfall"                  60
7 "rain with thunderstorm"    14</code></pre>
</div>
</div>
<p>If we just want to get information on which countries are in the data we can use <code>unique()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(bikes<span class="sc">$</span>weather_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Broken clouds          clear                  Cloudy                
[4] Rain                   scattered clouds       snowfall              
[7] rain with thunderstorm
7 Levels: clear scattered clouds Broken clouds Cloudy  ... snowfall</code></pre>
</div>
</div>
<p>The <code>psych</code> package also has a pretty useful function that can give you multiple summaries very quickly. It’s called <code>describe()</code>. It takes a data frame or a matrix as an argument and can provide a lot of summary statistics for numeric variables such as the mean, median, standard deviation, standard error, skew, kurtosis and quantiles. You can specify which of these you want by setting additional arguments</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Dołączanie pakietu: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Następujące obiekty zostały zakryte z 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">describe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">vars</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">trimmed</th>
<th style="text-align: right;">mad</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">range</th>
<th style="text-align: right;">skew</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cnt</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17414</td>
<td style="text-align: right;">1143.10164</td>
<td style="text-align: right;">1085.108068</td>
<td style="text-align: right;">844.0</td>
<td style="text-align: right;">973.25639</td>
<td style="text-align: right;">972.5856</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">7860.0</td>
<td style="text-align: right;">7860.0</td>
<td style="text-align: right;">1.3254784</td>
<td style="text-align: right;">1.5433229</td>
<td style="text-align: right;">8.2228756</td>
</tr>
<tr class="even">
<td style="text-align: left;">t1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">17414</td>
<td style="text-align: right;">12.46809</td>
<td style="text-align: right;">5.571818</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">12.36192</td>
<td style="text-align: right;">5.9304</td>
<td style="text-align: right;">-1.5</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">35.5</td>
<td style="text-align: right;">0.2038272</td>
<td style="text-align: right;">-0.2622630</td>
<td style="text-align: right;">0.0422229</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">17414</td>
<td style="text-align: right;">11.52084</td>
<td style="text-align: right;">6.615145</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">11.55978</td>
<td style="text-align: right;">7.4130</td>
<td style="text-align: right;">-6.0</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">40.0</td>
<td style="text-align: right;">-0.0583421</td>
<td style="text-align: right;">-0.6603278</td>
<td style="text-align: right;">0.0501291</td>
</tr>
<tr class="even">
<td style="text-align: left;">hum</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">17414</td>
<td style="text-align: right;">72.32495</td>
<td style="text-align: right;">14.313186</td>
<td style="text-align: right;">74.5</td>
<td style="text-align: right;">73.31433</td>
<td style="text-align: right;">14.8260</td>
<td style="text-align: right;">20.5</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">79.5</td>
<td style="text-align: right;">-0.5726832</td>
<td style="text-align: right;">-0.2563514</td>
<td style="text-align: right;">0.1084644</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_speed</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">17414</td>
<td style="text-align: right;">15.91306</td>
<td style="text-align: right;">7.894570</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">15.35255</td>
<td style="text-align: right;">7.4130</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">56.5</td>
<td style="text-align: right;">56.5</td>
<td style="text-align: right;">0.6688960</td>
<td style="text-align: right;">0.4483664</td>
<td style="text-align: right;">0.0598245</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Sometimes you want summary statistics grouped by some categorical variable (e.g.&nbsp;experimental condition). You can do it with <code>describe.by()</code> from <code>psych</code> package. It works the same way as <code>describe()</code> you just need to provide the <code>group</code> argument which tells R what variable to split the dataset by. Lets look at the dataset split by season. We will also round numeric values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(t1 <span class="sc">+</span> t2 <span class="sc">+</span> hum <span class="sc">+</span> cnt <span class="sc">~</span> season, <span class="at">data =</span> bikes, <span class="at">mat=</span><span class="cn">TRUE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(is.numeric, \(x) <span class="fu">round</span>(x, <span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">item</th>
<th style="text-align: left;">group1</th>
<th style="text-align: right;">vars</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">trimmed</th>
<th style="text-align: right;">mad</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">range</th>
<th style="text-align: right;">skew</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t11</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">spring</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4394</td>
<td style="text-align: right;">10.67</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">10.50</td>
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">25.5</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">t12</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4387</td>
<td style="text-align: right;">18.43</td>
<td style="text-align: right;">3.62</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">18.29</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t13</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">fall</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4303</td>
<td style="text-align: right;">13.04</td>
<td style="text-align: right;">4.29</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">13.01</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">-1.0</td>
<td style="text-align: right;">33.0</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">t14</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4330</td>
<td style="text-align: right;">7.69</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">7.68</td>
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">-1.5</td>
<td style="text-align: right;">16.5</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t21</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">spring</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4394</td>
<td style="text-align: right;">9.42</td>
<td style="text-align: right;">5.10</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">9.31</td>
<td style="text-align: right;">5.93</td>
<td style="text-align: right;">-2.5</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">28.5</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">t22</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4387</td>
<td style="text-align: right;">18.39</td>
<td style="text-align: right;">3.63</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">18.26</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">28.0</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t23</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">fall</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4303</td>
<td style="text-align: right;">12.51</td>
<td style="text-align: right;">5.06</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">12.70</td>
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">-4.5</td>
<td style="text-align: right;">32.5</td>
<td style="text-align: right;">37.0</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">t24</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4330</td>
<td style="text-align: right;">5.71</td>
<td style="text-align: right;">4.88</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">5.59</td>
<td style="text-align: right;">5.19</td>
<td style="text-align: right;">-6.0</td>
<td style="text-align: right;">16.5</td>
<td style="text-align: right;">22.5</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hum1</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">spring</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4394</td>
<td style="text-align: right;">68.60</td>
<td style="text-align: right;">15.23</td>
<td style="text-align: right;">71.0</td>
<td style="text-align: right;">69.28</td>
<td style="text-align: right;">16.31</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">77.0</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">-0.65</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">hum2</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4387</td>
<td style="text-align: right;">66.85</td>
<td style="text-align: right;">15.13</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">67.37</td>
<td style="text-align: right;">17.79</td>
<td style="text-align: right;">20.5</td>
<td style="text-align: right;">97.0</td>
<td style="text-align: right;">76.5</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">-0.77</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hum3</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">fall</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4303</td>
<td style="text-align: right;">76.10</td>
<td style="text-align: right;">12.21</td>
<td style="text-align: right;">77.0</td>
<td style="text-align: right;">76.92</td>
<td style="text-align: right;">12.60</td>
<td style="text-align: right;">31.0</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">69.0</td>
<td style="text-align: right;">-0.60</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">hum4</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4330</td>
<td style="text-align: right;">77.91</td>
<td style="text-align: right;">10.90</td>
<td style="text-align: right;">79.0</td>
<td style="text-align: right;">78.43</td>
<td style="text-align: right;">11.86</td>
<td style="text-align: right;">36.0</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">64.0</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cnt1</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">spring</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4394</td>
<td style="text-align: right;">1103.83</td>
<td style="text-align: right;">1039.00</td>
<td style="text-align: right;">823.0</td>
<td style="text-align: right;">945.91</td>
<td style="text-align: right;">973.33</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">5322.0</td>
<td style="text-align: right;">5322.0</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">15.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">cnt2</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">summer</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4387</td>
<td style="text-align: right;">1464.47</td>
<td style="text-align: right;">1250.76</td>
<td style="text-align: right;">1214.0</td>
<td style="text-align: right;">1299.39</td>
<td style="text-align: right;">1322.48</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">7860.0</td>
<td style="text-align: right;">7848.0</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">18.88</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cnt3</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">fall</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4303</td>
<td style="text-align: right;">1178.95</td>
<td style="text-align: right;">1095.65</td>
<td style="text-align: right;">898.0</td>
<td style="text-align: right;">1009.91</td>
<td style="text-align: right;">1000.76</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">5422.0</td>
<td style="text-align: right;">5413.0</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">16.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">cnt4</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">winter</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4330</td>
<td style="text-align: right;">821.73</td>
<td style="text-align: right;">807.44</td>
<td style="text-align: right;">632.0</td>
<td style="text-align: right;">684.04</td>
<td style="text-align: right;">687.93</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">4415.0</td>
<td style="text-align: right;">4405.0</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">12.27</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exploring-via-plots" class="level2">
<h2 class="anchored" data-anchor-id="exploring-via-plots">Exploring via plots</h2>
<p>Doing numeric exploration is always useful and can give you plenty of information about a dataset but in many situations a plot makes exploration much easier. It allows you to immediately spot certain problems like implausible outliers, weird (e.g.&nbsp;censored) distributions or types of relations (is it linear? quadratic? Does it make sense at all?). Lets look at some quick summaries of our variables with plots. We can start by simple histograms of numeric variables and a scatterplot to show the relation between numeric variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"var"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>var, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12eda_alt_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can immediately see the skew in some of the variables. You can also get a rough look at bivariate relations with <code>pairs.panels()</code> function from <code>psych</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(bikes <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12eda_alt_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>IT shows bivariate scatterplots, correlations and distributions for all the numeric variables. You can quickly see e.g.&nbsp;that actual and felt temperature are pretty much the same with correlation of .99.</p>
<p>Lets focus in a bit more detail on some of the variables like count, temperature and s:eason</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t1, <span class="at">y =</span> cnt, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>(<span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>season)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12eda_alt_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="a-cautionary-tale-the-boring-way" class="level3">
<h3 class="anchored" data-anchor-id="a-cautionary-tale-the-boring-way">A cautionary tale the boring way</h3>
<p>One of the reasons why plotting is very important and useful is that all sorts of data can provide you the same point estimate (like a mean or a regression slope). The most common example is the Anscombe quartet. It’s a set of 4 datasets with x and y variable each. Each of these have exactly the same correlation coefficient between x and y so you might be tempted to say they are pretty much the same, right? But if you plot them you’ll see this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-E216A64B.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Even though the regression line is the same on each plot you can immediately see that it makes sense only in the first one (top left). The top right one shows a quadratic and not a linear relation. The bottom left one clearly has an outlier that drives the regression line to be steeper. And the bottom right one shows pretty much no relation because entire variation in x is driven by a single data point. If we didn’t plot the data we wouldn’t realize just how different these datasets are. You could discover this in some numerical way (e.g.&nbsp;looking at regression diagnostics) but plotting makes it much faster and allows you to immediately spot the problem.</p>
</section>
<section id="a-cautionary-tale-the-fun-way" class="level3">
<h3 class="anchored" data-anchor-id="a-cautionary-tale-the-fun-way">A cautionary tale the fun way</h3>
<p>There is a more fun way to see the same point that was made by Anscombe. We’ll look at an experiment that was conducted to test how displaying information in the media affects attitude towards migrants. The researchers showed participants either a negative article or a neutral one and measured attitudes towards migrants. They also measured general exposure to the media (ie how much media does one consume) because they were interested in the relation between media consumption and attitudes towards migrants. They also recorded gender and age of participants. Lets load the data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,700
Columns: 5
$ gender         &lt;chr&gt; "female", "male", "male", "female", "female", "female",…
$ age            &lt;dbl&gt; 35, 35, 38, 18, 44, 50, 58, 53, 45, 35, 20, 58, 34, 35,…
$ condition      &lt;chr&gt; "control", "control", "control", "experimental", "contr…
$ media_exposure &lt;dbl&gt; 9.82, 9.54, 5.00, 9.22, 8.54, 6.60, 5.04, 4.54, 5.92, 1…
$ att_migrants   &lt;dbl&gt; 6.12, -0.62, -2.12, 5.68, 6.00, 0.54, 5.70, 7.04, 6.12,…</code></pre>
</div>
</div>
<p>Lets look at some summary statistics first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>experiment <span class="sc">%&gt;%</span>  </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span>  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_att =</span> <span class="fu">mean</span>(att_migrants),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_att =</span> <span class="fu">sd</span>(att_migrants)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">condition</th>
<th style="text-align: right;">mean_att</th>
<th style="text-align: right;">se_att</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">control</td>
<td style="text-align: right;">3.172235</td>
<td style="text-align: right;">0.1107740</td>
</tr>
<tr class="even">
<td style="text-align: left;">experimental</td>
<td style="text-align: right;">3.149035</td>
<td style="text-align: right;">0.1085498</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Well, it does not look like there are any meaningful differences between the conditions. We can also plot these differences:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>experiment <span class="sc">%&gt;%</span>   </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> att_migrants)) <span class="sc">+</span>  </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>) <span class="sc">+</span>  </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12eda_alt_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is a bit disappointing. We could say that we did not reject the null hypothesis and there is no support in the data that reading a negative article affect attitudes towards migrants relative to reading a neutral article. Lets at least look at the correlation between media exposure and attitude towards migrants. Maybe there is something interesting there? We can use the <code>cor()</code> function for it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(experiment<span class="sc">$</span>media_exposure, experiment<span class="sc">$</span>att_migrants)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2702737</code></pre>
</div>
</div>
<p>Well the correlation seems negative and it definitely is not small. Maybe we are finally on to something! So lets finally plot the data to see how it looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>experiment <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> media_exposure, <span class="at">y =</span> att_migrants)) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12eda_alt_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Whoops! This obviously makes no sense. We get a plot of a gorilla. This dataset is fabricated! This example is taken fully from a paper: Yanai, I, Lercher, M. (2020). A Hypothesis is a liability. <em>Genome Biology</em>, 21, 231. What they did was provide students with a very similar dataset as above and randomly assign their students into one of two condition: half the students were asked to test a specific hypothesis and half to just analyze the dataset. The researchers were interested how many students would find the gorilla. They found (although the sample was small) that students who were asked to test specific hypothesis were less likely to find the gorilla in the data than the students that were not assigned a specific hypothesis to test. This of course dos not mean we should throw hypotheses away. However it shows that being too focused on testing very specific things with our data we can miss some really big errors and unless we explore the data properly we might make terrible mistakes.</p>
<p>The key takeaway is that a lot of things that are wrong or at least problematic can be immediately spotted when you plot the data. e.g.&nbsp;in when comparing two conditions of an experiment you might spot that the whole effect is driven but just a few outliers. Or that some values are out of range. There are of course limits to what a plot can provide (if you want to quantify then you need more than a plot) but they often work very well for initial screening.</p>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<p>Download the dataset and its codebook</p>
<ol type="1">
<li>Look at the dataset and its codebook. Try to validate the data and make sure all variables are coded correctly</li>
<li>Explore the data with plots - does the data look ok?</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>